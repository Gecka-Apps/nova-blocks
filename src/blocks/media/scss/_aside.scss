.novablocks-media__aside {
	display: flex;

	@include above(desktop) {
		.has-image-on-the-left & {
			order: -1;
		}
	}

	@include below(desktop) {
		grid-column: span 2;
	}
}

.novablocks-media__grid {
	align-self: stretch;
	flex-grow: 1;
	margin-top: calc( var(--novablocks-media-grid-gap, 15) * -1px );
	margin-left: calc( var(--novablocks-media-grid-gap, 15) * -1px );

	display: grid;

	--smaller-column: calc( 75% - var(--novablocks-media-grid-proportions) * 0.5% );
	--bigger-column: calc( 25% + var(--novablocks-media-grid-proportions) * 0.5% );

	--actual-overlap: calc( var(--novablocks-media-scale) * var(--novablocks-media-overlap) / 100 );

	--difference: calc( 100 - var(--novablocks-media-scale, 100) );
	--scale: calc(var(--smaller-column) + var(--bigger-column) * var(--difference) / 100);


	//grid-gap: calc( var(--novablocks-media-grid-gap, 15) * 1px );
	min-height: 400px;
}

.novablocks-media__grid--2-columns {
	grid-template-columns: var(--bigger-column);
}

.novablocks-media__grid--2-rows {
	grid-template-rows: var(--bigger-column);
}

// fit images
.novablocks-media__image {
	position: relative;
	border-top: calc( var(--novablocks-media-grid-gap, 15) * 1px ) solid transparent;
	border-left: calc( var(--novablocks-media-grid-gap, 15) * 1px ) solid transparent;

	display: flex;

	img {
		--novablocks-media-proportions-ratio: 0;
		--novablocks-media-scale: calc( 1 - var(--novablocks-media-proportions) * var(--novablocks-media-proportions-ratio) / 100 );
		@include image-cover;
	}
}

// gallery with 1 item
.novablocks-media__image:first-child:last-child,
.novablocks-media__placeholder {
	grid-column: span 2;
}

.novablocks-media__image {
	--novablocks-media-scale-ratio: 1;
	--novablocks-media-overlap-ratio: 1;

	//img {
	//	box-shadow:
	//		0px 64px 128px rgba(42, 54, 52, 0.1),
	//		0px 16px 32px rgba(42, 54, 52, 0.1);
	//}
}

.novablocks-media__image:first-child:nth-last-child(2) {
	grid-row: 1 / span 1;
	grid-column: 1 / span 1;

	height: calc( 100% - var(--smaller-column) * var(--novablocks-media-scale) / 100 );
	margin-bottom: auto;
	margin-right: calc( -0.5% * var(--actual-overlap) );

	& ~ .novablocks-media__image:last-child {
		grid-row: 1 / span 1;
		grid-column: 2 / span 1;

		height: calc( 100% - var(--bigger-column) * var(--novablocks-media-scale) / 100 );
		margin-top: auto;
		margin-left: calc( -0.5% * var(--actual-overlap) );
	}
}

// gallery with 3 items
.novablocks-media__image:first-child:nth-last-child(3) {
	grid-row: 1 / span 1;
	grid-column: 1 / span 2;

	justify-self: center;
	width: calc( var(--scale, 100%) * var(--novablocks-media-scale-ratio) );
	margin-left: calc( 0.5% * var(--actual-overlap) * var(--novablocks-media-overlap-ratio) );

	img {
		--novablocks-media-proportions-ratio: 0.25;
	}

	& ~ .novablocks-media__image:nth-child(2) {
		grid-row: 2 / span 1;
		grid-column: 1 / span 1;

		margin-top: calc( -1% * var(--actual-overlap) );

		img {
			--novablocks-media-proportions-ratio: 0.5;
		}
	}

	& ~ .novablocks-media__image:last-child {
		grid-row: 2 / span 1;
		grid-column: 2 / span 1;

		margin-bottom: calc( 0.5% * var(--actual-overlap) );
	}
}

.novablocks-media__image:first-child:nth-last-child(4) {
	grid-row: 1 / span 1;
	grid-column: 1 / span 1;

	margin-bottom: calc( -1% * var(--actual-overlap) );

	& ~ .novablocks-media__image:nth-child(2) {
		grid-row: 1 / span 1;
		grid-column: 2 / span 1;

		height: calc( var(--scale, 100%) * var(--novablocks-media-scale-ratio) );
		align-self: flex-end;
	}

	& ~ .novablocks-media__image:nth-child(3) {
		grid-row: 2 / span 1;
		grid-column: 1 / span 1;
		justify-self: flex-end;

		margin-right: calc( -0.75% * var(--actual-overlap) );

		width: calc( var(--scale, 100%) * var(--novablocks-media-scale-ratio) );
	}

	& ~ .novablocks-media__image:last-child {
		grid-row: 2 / span 1;
		grid-column: 2 / span 1;

		margin-top: calc( -0.75% * var(--actual-overlap) );
		margin-left: calc( -0.75% * var(--actual-overlap) );

		width: calc( var(--scale, 100%) * var(--novablocks-media-scale-ratio) );
		height: calc( var(--scale, 100%) * var(--novablocks-media-scale-ratio) );
	}
}

// gallery with more than 4 items
.novablocks-media__image:nth-child(n + 5) {
	display: none;
}

.novablocks-media__image:nth-child(1),
.novablocks-media__image:nth-child(4) {

	&[class][class][class] img {
		transform: rotate( calc( var(--novablocks-media-rotate, 0) * -0.05deg ) );
	}
}

.novablocks-media__image:nth-child(2),
.novablocks-media__image:nth-child(3) {

	&[class][class][class] img {
		transform: rotate( calc( var(--novablocks-media-rotate, 0) * 0.05deg ) );
	}
}
